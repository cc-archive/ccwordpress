FileETag INode MTime Size

<Location /licenses>
	DirectoryIndex deed
	DefaultType text/html
	AddDefaultCharset utf-8
</Location>

# Always serve up deeds as text/html, even when the country code
# extension makes Apache think it's something else, like .pl being
# a perl script instead of Poland.
<LocationMatch "^/licenses/.*/deed.*$">
	ForceType text/html
</LocationMatch>

# Adding support for /home/<user>/public_html (nkinkade 2007-12-13)
<IfModule mod_userdir.c>
	UserDir public_html
	UserDir disabled root
	<Directory /home/*/public_html>
		RewriteEngine off
		AllowOverride FileInfo AuthConfig Limit
		Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
	</Directory>
</IfModule>

# Necessary because we only want self-referential URLs to point to
# creativecommons.org and nothing else like www.CC.org, etc.
# (nkinkade 2008-03-11)
UseCanonicalName On

### ------------------------- ####
##   BEGIN mod_rewrite SECTION  ##
### ------------------------- ####

RewriteEngine on

RewriteMap uppercase int:toupper

Options +ExecCGI

# Uncomment these lines and adjust the log level for debugging.
# Make sure to recomment them and restart Apache when done.
#RewriteLog /tmp/rewrite.log
#RewriteLogLevel 7

# Per Mike, redirect anything coming to www.creativecommons.org to plain
# creativecommons.org (nkinkade 20071102)
RewriteCond %{HTTP_HOST} =www.creativecommons.org
RewriteRule ^/(.*)$ http://%{SERVER_NAME}/$1 [L,R=301]

# Per mail from Mike, redirect both of these to /about/licenses
RewriteRule /about/sampling-movie http://%{SERVER_NAME}/about/licenses/ [R=301,L]
RewriteRule /about/licenses/sampling http://%{SERVER_NAME}/about/licenses/ [R=301,L]

# Don't allow anyone to access legalcode directly via the /legalcode directory.
# The following rule should be sufficient to induce a 404 error, unless by some
# astounding coincidence someone puts a file or directory called 'roflcopter'
# in the webroot.  For more info about 'roflcopter' see the cc_permalink_mapper
# plugin.  Nathan Kinkade 2007-12-18
RewriteRule ^/legalcode /index.php?p=9999999999&roflcopter [L]

# Map legalcode/rdf requests to the appropriate files.  NOTE: this must come before the
# following rule that catches any requests to /licenses/by* where the file
# doesn't actually exist (nkinkade 2008-01-24)
RewriteRule ^/licenses/(.*)sampling\+/1.0/legalcode$ /legalcode/$1samplingplus_1.0.html [L]
RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/legalcode$ /legalcode/$1_$2.html [L]
RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/legalcode\.([a-z][a-z])$ /legalcode/$1_$2_$3.html [L]
RewriteRule ^/licenses/(.*)sampling\+/1.0/(.*)/legalcode$ /legalcode/$1samplingplus_1.0_$2.html [L]
RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/(.*)/legalcode$ /legalcode/$1_$2_$3.html [L]
RewriteRule ^/licenses/index.rdf$ /rdf/index.rdf [L,T=application/rdf+xml]
RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/license_rdf$ /license_rdf/creativecommons.org_licenses_$1_$2_.rdf [L,T=application/rdf+xml]
RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/([a-z]+)/license_rdf$ /license_rdf/creativecommons.org_licenses_$1_$2_$3_.rdf [L,T=application/rdf+xml]
RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/rdf$ /license_rdf/creativecommons.org_licenses_$1_$2_.rdf [L,T=application/rdf+xml]
RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/([a-z]+)/rdf$ /license_rdf/creativecommons.org_licenses_$1_$2_$3_.rdf [L,T=application/rdf+xml]


# Changing the following rule so that we can handle languages that are denoted using
# more than a 2 char lowercase code.  The was spurred by the examle of the Serbian
# licenses, which are in both Cyrillic and Latin scripts which some sources indicate
# should be identified as sr-Latn and sr-Cyrl.  Nathan Kinkade 2008-01-04
#RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/(.*)/legalcode\.([a-z][a-z])$ /legalcode/$1_$2_$3_$4.html [L]
RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/(.*)/legalcode\.([A-Za-z-]+)$ /legalcode/$1_$2_$3_$4.html [L]

# Map backwardly named license types to their actual location
RewriteRule ^/licenses/by-nd-nc/2.0/(.*)$ http://creativecommons.org/licenses/by-nc-nd/2.0/$1 [R]
RewriteRule ^/licenses/by-nc-nd/1.0/(.*)$ http://creativecommons.org/licenses/by-nd-nc/1.0/$1 [R]

# If a particular jurisdiction has a page at /international or /worldwide, but doesn't
# yet have the deeds and or licenses available, then don't show a the /international/<code>
# page when someone tries to access the licenses.  A recent example:  The Philippenes had
# a page at /international/ph/ ... this page had a slug of 'ph'.  However the licenses
# still weren't ready, yet accesses to /licenses/<type>/<version>/ph/ were
# returning the /international/ph/ page because, apparently, Wordpress was interpreting the
# 'ph' as a page slug.  So we just redirect the original request to some (hopefully)
# impossible URL that should return a 404.  For more info about 'roflcopter' see the
# cc_permalink_mapper plugin.  (nkinkade 2007-12-18)
RewriteCond %{REQUEST_URI} ^/international
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-f
RewriteRule ^/licenses/by.*?/\d\.\d/\w\w/ /index.php?p=9999999999&roflcopter [L]

# Any request that comes in to /international/xx should be redirected to
# /international/xx/ (trailing slash).  Otherwise the relative links to the
# translated-license.pdf file will fail to point to the right place on mirrors.
# This problem was brough to my attention via an email exchange with Michelle
# Thorne and Ben of CC Hong Kong (nkinkade 2008-02-26)
RewriteRule ^/international/(\w\w)$ http://%{SERVER_NAME}/international/$1/ [R=301,L]

# Redirect any requests to /about/ccvideos to support.(cc).org/videos
# (nkinkade 2008-04-04)
RewriteRule ^/about/ccvideo http://support.creativecommons.org/videos/ [L,R=301]

RewriteRule ^/apps/(.*) http://127.0.0.1:8002/$1 [L,P]

# Per email from Mike (nkinkade 2008-06-10)
RewriteRule ^/discuss/?$ http://creativecommons.org/contact#discuss [R=301,L]

RewriteRule http http://creativecommons.org/ [R]
RewriteRule index_html http://creativecommons.org/ [R]
RewriteRule ^/policy$ http://creativecommons.org/policies [R]
RewriteRule ^/robots.txt$ /robots.txt [L]
RewriteRule ^/legal/.*$ http://creativecommons.org/ [R]
RewriteRule ^/press/.*$ http://creativecommons.org/weblog/archive/ [R]
RewriteRule ^/press$ http://creativecommons.org/weblog/archive/ [R]
RewriteRule ^/find.*$ http://search.creativecommons.org/ [R]
RewriteRule ^/images/(.*) /images/$1 [L]
RewriteRule ^/includes/(.*) /includes/$1 [L]
RewriteRule ^/support(.*) http://support.creativecommons.org$1 [R,L]
RewriteRule ^/about/supporters$ http://support.creativecommons.org/supporters$1 [R,L]
RewriteRule ^/icons/(.*) /icons/$1 [L]
RewriteRule ^/favicon.ico /favicon.ico [L]
#RewriteRule ^/weblog/rss /weblog/rss [L]
#RewriteRule ^/weblog/$ /weblog/index.html [L]
#RewriteRule ^/weblog/*$ http://creativecommons.org/weblog/archive/ [R]
#RewriteRule ^/weblog/archive/$ /weblog/archive/index.html [L]

RewriteRule ^/science.*$ http://sciencecommons.org/ [R]
RewriteRule ^/participate$ http://wiki.creativecommons.org/ [R]
RewriteRule ^/technology/$ http://wiki.creativecommons.org/Developer [R]
RewriteRule ^/technology/contributor.*$ http://wiki.creativecommons.org/Developer [R]
RewriteRule ^/technology/screen.*$ http://wiki.creativecommons.org/Developer [R]
RewriteRule ^/technology/search.html$ http://search.creativecommons.org/ [R]
RewriteRule ^/technology/web$ http://wiki.creativecommons.org/HOWTO_Tag_HTML_pages [R]
RewriteRule ^/technology/web-integration$ http://wiki.creativecommons.org/Web_Integration_Guide [R]
RewriteRule ^/technology/usingmarkup$ http://wiki.creativecommons.org/UsingMarkup [R]
RewriteRule ^/technology/mp3$ http://wiki.creativecommons.org/MP3 [R]
RewriteRule ^/technology/xmp.*$ http://wiki.creativecommons.org/XMP [R]
RewriteRule ^/faq.*$ http://wiki.creativecommons.org/FAQ [R]
RewriteRule ^/tools/ccpublisher http://wiki.creativecommons.org/CcPublisher [R]
RewriteRule ^/tools/cclookup http://wiki.creativecommons.org/CcLookup [R]
RewriteRule ^/about/affiliates.*$ http://creativecommons.org/about/supporters [R]
RewriteRule ^/aboutus/(.*)$ http://creativecommons.org/learn/aboutus/$1 [R]
RewriteRule ^/concepts/examples$ http://creativecommons.org/learn/licenses/examples [R]
RewriteRule ^/concepts/(.*)$ http://creativecommons.org/learn/legal/$1 [R]
RewriteRule ^/draft/(.*)$ http://creativecommons.org/learn/licenses/$1 [R]
RewriteRule ^/features(.*)$ http://creativecommons.org/learn/features$1 [R]
RewriteRule ^/metadata(.*)$ http://wiki.creativecommons.org/Metadata [R]
RewriteRule ^/news/blog/$ http://creativecommons.org/weblog/ [R]
RewriteRule ^/news/pressarchive$ http://creativecommons.org/press/archive [R]
RewriteRule ^/news/pressarchive.html$ http://creativecommons.org/press/archive [R]
RewriteRule ^/news/pressreleases$ http://creativecommons.org/press-releases/archive-short [R]
RewriteRule ^/news/pressreleases.html$ http://creativecommons.org/press-releases/archive-short [R]
RewriteRule ^/pressarchive$ http://creativecommons.org/press/archive [R]
RewriteRule ^.*/embedding$ http://wiki.creativecommons.org/Embedded_Metadata [R]
RewriteRule ^.*/technology/.*$ http://wiki.creativecommons.org/Developer [R]
RewriteRule ^/freeculture.*$ http://lessig.org/freeculture [R]
RewriteRule ^/getcontent.*$ http://creativecommons.org/find/ [R]
RewriteRule ^/learn/getcontent$ http://creativecommons.org/find/ [R]
RewriteRule ^/learn/features/(.*)$ http://creativecommons.org/find/ [R]
RewriteRule ^/learn/collaborators$ http://creativecommons.org/learn/aboutus/affiliates [R]
RewriteRule ^/press$ http://creativecommons.org/press/ [R]
RewriteRule ^/store$ http://creativecommons.org/support/ [R]
RewriteRule ^/donate$ http://creativecommons.org/support/ [R]
RewriteRule ^/licesne(.*)$ http://creativecommons.org/license$1 [R]
RewriteRule ^/license/devnations$ http://creativecommons.org/retiredlicenses [R]
RewriteRule ^/license/cc-gpl-br$ http://creativecommons.org/license/cc-gpl [R]
RewriteRule ^/license/cc-lgpl-br$ http://creativecommons.org/license/cc-lgpl [R]
RewriteRule ^/licenses/publicdomain/1.0(.*)$ http://creativecommons.org/licenses/publicdomain/ [R]
RewriteRule ^/projects/international(.*)$ http://creativecommons.org/worldwide$1 [R]
RewriteRule ^/worldwide/(..)$ http://creativecommons.org/worldwide/$1/ [R]
RewriteRule ^/projects/science(.*)$ http://science.creativecommons.org/ [R]
RewriteRule ^/(.*?.pdf)$ http://mirrors.creativecommons.org/$1 [R]
RewriteRule ^/presskit/(.+)\.([a-z]+)$ http://mirrors.creativecommons.org/presskit/$1.$2 [R]
RewriteRule ^(.*)CVS.*$ $1 [R]
RewriteRule ^/images.*/$ http://creativecommons.org/ [R]
RewriteRule /learn/$ http://creativecommons.org/about/ [R]
RewriteRule /learn/aboutus/$ http://creativecommons.org/about/history [R]
RewriteRule /learn/aboutus/people$ http://creativecommons.org/about/people [R]
RewriteRule /learn/aboutus/supporters$ http://creativecommons.org/about/supporters [R]
RewriteRule /learn/aboutus/affiliates$ http://creativecommons.org/about/affiliates [R]
RewriteRule /learn/artistscorners/$ http://creativecommons.org/ [R]
RewriteRule /learn/artistscorners/musicians$ http://creativecommons.org/audio/ [R]
RewriteRule /learn/artistscorners/photographers$  http://creativecommons.org/image/ [R]
RewriteRule /learn/artistscorners/writers$ http://creativecommons.org/text/ [R]
RewriteRule /learn/artistscorners/filmmakers$ http://creativecommons.org/video/ [R]
RewriteRule /learn/artistscorners/educators$ http://creativecommons.org/education/ [R]
RewriteRule /learn/licenses/.*$ http://creativecommons.org/about/licenses/ [R]
RewriteRule /learn/licenses$ http://creativecommons.org/about/licenses/ [R]
RewriteRule /learn/legal/$ http://creativecommons.org/about/legal/ [R]
RewriteRule /support/video$ http://creativecommons.org/support/videos [R]
RewriteRule /support/getabutton$ http://creativecommons.org/support/supportcc [R]
RewriteRule /support/summit$ http://creativecommons.org/support/ [R]
RewriteRule /projects/sampling http://creativecommons.org/about/sampling [R]
RewriteRule /drafts/wiki_0.5$ http://creativecommons.org/licenses/by-sa/2.5/ [R]
RewriteRule /technology/challenges$ http://wiki.creativecommons.org/TechChallenges [R]
RewriteRule /technology/accessories$ http://wiki.creativecommons.org/Browser_Plugin [R]
RewriteRule /salon.*$ http://wiki.creativecommons.org/Salon [R]
RewriteRule ^/icon/(.*)$ http://creativecommons.org/icons/$1 [R]
RewriteRule ^/licenses/(.*)/2.0/ar/(.*)$ http://creativecommons.org/licenses/$1/2.5/ar/$2 [R]
RewriteRule ^/contest/(.*)$ http://creativecommons.org/video/movingimagecontest [R]
RewriteRule ^/license/meet-the-licenses$ http://creativecommons.org/about/licenses/meet-the-licenses [R]
RewriteRule ^/licenses/meet-the-licenses$ http://creativecommons.org/about/licenses/meet-the-licenses [R]
RewriteRule ^/licenses/(.*)([0-9])$ http://creativecommons.org/licenses/$1$2/ [R]
RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/([a-z][a-z])$ http://creativecommons.org/licenses/$1/$2/$3/ [R]
RewriteRule ^/licenses/(.*)/([0-9]\.[0-9])/([Ss]cotland)$ http://creativecommons.org/licenses/$1/$2/scotland/ [R]
RewriteRule (.*)licence(.*) http://creativecommons.org$1license$2 [R]
RewriteRule ^/licenses$ http://creativecommons.org/licenses/ [R]


RewriteRule ^/licenses/BSD/legalcode http://opensource.org/licenses/bsd-license.php [L,R]
RewriteRule ^/licenses/MIT/legalcode http://opensource.org/licenses/mit-license.php [L,R]

RewriteRule ^/licenses/(.*)/deed.(.*)/$ http://creativecommons.org/ [R]

RewriteRule .*rdf/$ http://creativecommons.org/ [R]
RewriteRule .*legalcode/$ http://creativecommons.org/ [R]
RewriteRule ^/http.* http://creativecommons.org/ [R]
RewriteRule .*/author$ http://creativecommons.org/ [R]
RewriteRule .*/login_form$ http://creativecommons.org/ [R]
RewriteRule .*/manage.*$ http://creativecommons.org/ [R]
RewriteRule .*/archive/archive.* http://creativecommons.org/ [R]
RewriteRule ^/counter.* http://creativecommons.org/ [R]
RewriteRule ^/200.* http://creativecommons.org/ [R]
RewriteRule ^/_.* http://creativecommons.org/ [R]
RewriteRule ^/wiki.* http://wiki.creativecommons.org/ [R]

# Rules added by Nathan Kinkade per:
# http://spreadsheets.google.com/a/creativecommons.org/ccc?key=pQ4dfneb-JCMJyeBxHBpjFQ&inv=nkinkade@creativecommons.org&t=7085484706513249959&guest
RewriteRule ^/audio/publish-internetarchive http://wiki.creativecommons.org/HOWTO_Publish#Internet_Archive [R,NE,L]
RewriteRule ^/audio/publish-soundclick http://wiki.creativecommons.org/HOWTO_Publish#Soundclick [R,NE,L]
RewriteRule ^/audio/publish-morpheus http://wiki.creativecommons.org/HOWTO_Publish#Morpheus [R,NE,L]
RewriteRule ^/audio/publish-website http://wiki.creativecommons.org/HOWTO_Publish#Adding_a_license_to_your_audio_page [R,NE,L]
RewriteRule ^/image/publish-flickr http://wiki.creativecommons.org/HOWTO_Publish#Flickr [R,NE,L]
RewriteRule ^/image/publish-buzznet http://wiki.creativecommons.org/HOWTO_Publish#Buzznet [R,NE,L]
RewriteRule ^/image/publish-website http://wiki.creativecommons.org/HOWTO_Publish#Adding_a_license_to_your_photo_pages [R,NE,L]
RewriteRule ^/video/publish-internetarchive http://wiki.creativecommons.org/HOWTO_Publish#Internet_Archive_2 [R,NE,L]
RewriteRule ^/video/publish-website http://wiki.creativecommons.org/HOWTO_Publish#Adding_a_license_to_your_video_page [R,NE,L]
RewriteRule ^/text/publish-weblogs http://wiki.creativecommons.org/HOWTO_Publish#Blog [R,NE,L]
RewriteRule ^/text/publish-website http://wiki.creativecommons.org/HOWTO_Publish#Adding_a_license_to_your_existing_website [R,NE,L]
RewriteRule ^/education/?$ http://learn.creativecommons.org [R=301,L]
RewriteRule ^/education/publish-website http://wiki.creativecommons.org/HOWTO_Publish#Adding_a_license_to_your_existing_website_2 [R,NE,L]
RewriteRule ^/projects/founderscopyright.*$ - [L]
RewriteRule ^/projects/(.+) http://wiki.creativecommons.org/$1 [R,NE,L]

# Added by nkinkade 2007-09-28 per email from Mike.
RewriteRule ^/license/publicdomain/?$ http://creativecommons.org/license/publicdomain-2/ [L,R]

RewriteRule ^/video/([-a-z0-9]+)/?$ /index.php?category_name=video&name=$1 [QSA,L]
RewriteRule ^/audio/([-a-z0-9]+)/?$ /index.php?category_name=audio&name=$1 [QSA,L]
RewriteRule ^/image/([-a-z0-9]+)/?$ /index.php?category_name=image&name=$1 [QSA,L]
RewriteRule ^/text/([-a-z0-9]+)/?$ /index.php?category_name=text&name=$1 [QSA,L]
RewriteRule ^/education/([-a-z0-9]+)/?$ /index.php?category_name=education&name=$1 [QSA,L]
RewriteRule ^/commoners/([-a-z0-9]+)/?$ /index.php?category_name=commoners&name=$1 [QSA,L]

RewriteRule ^/license/pngie.htc$ /includes/pngie.htc [L]

RewriteRule ^/license$ http://creativecommons.org/license/ [L,R]

RewriteRule ^/(license|licenses)/@@/cc/cc3/(.*)$ /wp-content/themes/cc3/$2 [L]
RewriteRule ^/(license|licenses)/@@/cc/cc4/(.*)$ /wp-content/themes/cc4/$2 [L]
RewriteRule ^/(license|licenses)/@@/cc/(.*)$ /$2 [L]

## ADDED BY ASHEESH 2007-09-27
RewriteRule ^/licenses/by-nc-nd/2.0/deed-music$ http://creativecommons.org/licenses/by-nc-nd/2.0/ [L,R=301]
# END ADD BY ASHEESH

## ADDED BY ASHEESH 2007-09-23
RewriteRule ^/about/license$ http://creativecommons.org/about/licenses [L,R]
## END ADD BY ASHEESH

# Static License Deeds -- NRY
#  Rewrite the filenames, normalizing the locale naming
RewriteRule ^/licenses/(.*)/deed\.([a-z]+)([_\-])([a-z]+) /licenses/$1/deed.$2_${uppercase:$4} [R,L]

# License Engine -- NRY
#  If the file does not exist, pass it to Zope; note that we include /licenses
#  here even though 99% of those files are statically served since a few are
#  not.  Passing to Zope handles i18n for us.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^/(license|characteristic)/(.*) http://127.0.0.1:9080/++vh++http:creativecommons.org:80/++/$1/$2 [L,P]
RewriteRule ^/licenses/disclaimer-popup$ http://127.0.0.1:9080/++vh++http:creativecommons.org:80/++/licenses/disclaimer-popup [L,P]
RewriteRule ^/licenses/$ http://127.0.0.1:9080/++vh++http:creativecommons.org:80/++/licenses/ [L,P]


RewriteRule ^/(worldwide|international)/translating http://wiki.creativecommons.org/Translating [R]
RewriteRule ^/project/(.*) http://wiki.creativecommons.org/$1 [R]

# To handle /international - oct 1, 2007 (aroberts)
RewriteRule ^/worldwide(.*) http://creativecommons.org/international$1 [R]

# Rules added by Nathan Kinkade per:
# http://spreadsheets.google.com/a/creativecommons.org/ccc?key=pQ4dfneb-JCMJyeBxHBpjFQ&inv=nkinkade@creativecommons.org&t=7085484706513249959&guest
RewriteRule ^/about/legal/?$  http://wiki.creativecommons.org/Legal_Concepts [R,L]
RewriteRule ^/about/legal/cultivating http://wiki.creativecommons.org/Cultivating_the_Public_Domain [R,L]
Rewriterule ^/about/history http://wiki.creativecommons.org/History [R,L]
Rewriterule ^/about/licenses/fullrights http://wiki.creativecommons.org/Baseline_Rights [R,L]
Rewriterule ^/about/licenses/examples http://wiki.creativecommons.org/License_Examples [R,L]
Rewriterule ^/about/licenses/how1 http://wiki.creativecommons.org/Howitworks_Comic1 [R,L]
Rewriterule ^/about/licenses/how2 http://wiki.creativecommons.org/Howitworks_Comic2 [R,L]
Rewriterule ^/about/licenses/how3 http://wiki.creativecommons.org/Howitworks_Comic3 [R,L]
Rewriterule ^/about/licenses/how4 http://wiki.creativecommons.org/Howitworks_Comic4 [R,L]
Rewriterule ^/about/licenses/comics1 http://wiki.creativecommons.org/Spectrumofrights_Comic1 [R,L]
Rewriterule ^/about/licenses/comics2 http://wiki.creativecommons.org/Spectrumofrights_Comic2 [R,L]
Rewriterule ^/about/licenses/comics3 http://wiki.creativecommons.org/Spectrumofrights_Comic3 [R,L]
Rewriterule ^/about/licenses/comics4 http://wiki.creativecommons.org/Spectrumofrights_Comic4 [R,L]
